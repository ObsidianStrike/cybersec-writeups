"use strict";(self.webpackChunkcybersec_writeups=self.webpackChunkcybersec_writeups||[]).push([[335],{6688:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"concept/lateral-movement","title":"Lateral Movement Explained","description":"Understand what lateral movement is, how it\'s accomplished, and why it\'s critical in offensive operations.","source":"@site/docs/concept/lateral-movement.md","sourceDirName":"concept","slug":"/concept/lateral-movement","permalink":"/docs/concept/lateral-movement","draft":false,"unlisted":false,"editUrl":"https://github.com/ObsidianStrike/cybersec-writeups/tree/main/docs/concept/lateral-movement.md","tags":[{"inline":true,"label":"post-exploitation","permalink":"/docs/tags/post-exploitation"},{"inline":true,"label":"red-team","permalink":"/docs/tags/red-team"},{"inline":true,"label":"movement","permalink":"/docs/tags/movement"},{"inline":true,"label":"pivoting","permalink":"/docs/tags/pivoting"},{"inline":true,"label":"lateral","permalink":"/docs/tags/lateral"},{"inline":true,"label":"diataxis:explanation","permalink":"/docs/tags/diataxis-explanation"}],"version":"current","sidebarPosition":15,"frontMatter":{"id":"lateral-movement","title":"Lateral Movement Explained","description":"Understand what lateral movement is, how it\'s accomplished, and why it\'s critical in offensive operations.","slug":"/concept/lateral-movement","sidebar_label":"Lateral Movement","sidebar_position":15,"tags":["post-exploitation","red-team","movement","pivoting","lateral","diataxis:explanation"]},"sidebar":"tutorialSidebar","previous":{"title":"Priv Esc","permalink":"/docs/concept/priv-esc"},"next":{"title":"Actions on Objectives","permalink":"/docs/concept/actions-on-objective"}}');var i=t(4848),r=t(8453);const o={id:"lateral-movement",title:"Lateral Movement Explained",description:"Understand what lateral movement is, how it's accomplished, and why it's critical in offensive operations.",slug:"/concept/lateral-movement",sidebar_label:"Lateral Movement",sidebar_position:15,tags:["post-exploitation","red-team","movement","pivoting","lateral","diataxis:explanation"]},l="Lateral Movement",a={},c=[{value:"\ud83e\udded Why Lateral Movement Matters",id:"-why-lateral-movement-matters",level:2},{value:"\ud83d\udd11 Core Techniques",id:"-core-techniques",level:2},{value:"\ud83d\udd17 Credential Abuse",id:"-credential-abuse",level:3},{value:"\ud83d\udee0 Protocol-Based Movement",id:"-protocol-based-movement",level:3},{value:"\ud83e\udde0 Application Layer &amp; Living-off-the-Land",id:"-application-layer--living-off-the-land",level:3},{value:"\ud83e\uddea Common Tools for Lateral Movement",id:"-common-tools-for-lateral-movement",level:2},{value:"\ud83d\udcd0 Typical Workflow",id:"-typical-workflow",level:2},{value:"\ud83e\udde0 OPSEC Considerations",id:"-opsec-considerations",level:2},{value:"\ud83d\udd12 Evasion Tips",id:"-evasion-tips",level:3},{value:"\ud83e\udded Where Lateral Movement Fits",id:"-where-lateral-movement-fits",level:2},{value:"\ud83d\udccc Summary",id:"-summary",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"lateral-movement",children:"Lateral Movement"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Lateral Movement"})," refers to the techniques used by an attacker to ",(0,i.jsx)(n.strong,{children:"move across a network"}),", accessing additional systems, accounts, and data after compromising an initial host."]}),"\n",(0,i.jsxs)(n.p,{children:["This step is crucial in post-exploitation because it allows adversaries to ",(0,i.jsx)(n.strong,{children:"expand their access"}),", ",(0,i.jsx)(n.strong,{children:"escalate privileges"}),", ",(0,i.jsx)(n.strong,{children:"harvest credentials"}),", and ultimately reach ",(0,i.jsx)(n.strong,{children:"high-value targets"})," like domain controllers, critical servers, or sensitive data repositories."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-why-lateral-movement-matters",children:"\ud83e\udded Why Lateral Movement Matters"}),"\n",(0,i.jsx)(n.p,{children:"Initial compromise is often limited to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A single workstation or endpoint"}),"\n",(0,i.jsx)(n.li,{children:"A low-privileged domain user"}),"\n",(0,i.jsx)(n.li,{children:"A segmented network zone"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Lateral movement helps attackers:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Bypass network segmentation"}),"\n",(0,i.jsx)(n.li,{children:"Move from user to admin accounts"}),"\n",(0,i.jsx)(n.li,{children:"Access additional credentials (token theft, harvesting)"}),"\n",(0,i.jsx)(n.li,{children:"Reach crown-jewel assets (Active Directory, databases, file servers)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["It transforms a ",(0,i.jsx)(n.strong,{children:"single compromised node"})," into ",(0,i.jsx)(n.strong,{children:"domain-wide compromise"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-core-techniques",children:"\ud83d\udd11 Core Techniques"}),"\n",(0,i.jsx)(n.h3,{id:"-credential-abuse",children:"\ud83d\udd17 Credential Abuse"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pass-the-Hash (PtH)"})," \u2013 Use stolen NTLM hashes to authenticate without plaintext password."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pass-the-Ticket (PtT)"})," \u2013 Use forged or stolen Kerberos TGT/TGS tickets."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Over-Pass-the-Hash"})," \u2013 Combine NTLM credentials to request Kerberos tickets."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Token Impersonation"})," \u2013 Duplicate existing access tokens for impersonation."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-protocol-based-movement",children:"\ud83d\udee0 Protocol-Based Movement"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SMB / WMI / WinRM"})," \u2013 Remote code execution on Windows systems"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"RDP"})," \u2013 Full GUI session into another system"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PsExec"})," \u2013 Remote service creation to launch executables"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"SSH"})," \u2013 Primary movement vector on Linux systems"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-application-layer--living-off-the-land",children:"\ud83e\udde0 Application Layer & Living-off-the-Land"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Scheduled Tasks"})," \u2013 Set tasks on remote systems to run payloads"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Service Creation"})," \u2013 Register and start services that run attacker code"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DLL Injection / Process Hollowing"})," \u2013 For stealthy code execution on remote machines"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"PowerShell Remoting"})," \u2013 ",(0,i.jsx)(n.code,{children:"Invoke-Command"}),", ",(0,i.jsx)(n.code,{children:"Enter-PSSession"})," for remote ops"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-common-tools-for-lateral-movement",children:"\ud83e\uddea Common Tools for Lateral Movement"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Tool"}),(0,i.jsx)(n.th,{children:"Platform"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"PsExec"})}),(0,i.jsx)(n.td,{children:"Windows"}),(0,i.jsx)(n.td,{children:"Fast, noisy, EDR monitored"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"WMIExec.py"})}),(0,i.jsx)(n.td,{children:"Windows"}),(0,i.jsx)(n.td,{children:"Python-based alternative"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"CrackMapExec"})}),(0,i.jsx)(n.td,{children:"Windows"}),(0,i.jsx)(n.td,{children:"Swiss army knife for SMB/WinRM/RDP"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Impacket suite"})}),(0,i.jsx)(n.td,{children:"Windows"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"smbexec"}),", ",(0,i.jsx)(n.code,{children:"wmiexec"}),", ",(0,i.jsx)(n.code,{children:"atexec"}),", ",(0,i.jsx)(n.code,{children:"dcomexec"}),", etc."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Sliver / Cobalt Strike"})}),(0,i.jsx)(n.td,{children:"Cross-platform"}),(0,i.jsx)(n.td,{children:"Beaconing C2s that support lateral ops"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"SSH (native)"})}),(0,i.jsx)(n.td,{children:"Linux"}),(0,i.jsxs)(n.td,{children:["With stolen keys, ",(0,i.jsx)(n.code,{children:".ssh/authorized_keys"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Ansible / SaltStack"})}),(0,i.jsx)(n.td,{children:"Linux"}),(0,i.jsx)(n.td,{children:"If internal automation tools can be hijacked"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-typical-workflow",children:"\ud83d\udcd0 Typical Workflow"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"Initial Access\n      \u2193\nCredential Dumping (e.g., LSASS, SAM)\n      \u2193\nToken/Theft/Harvesting (e.g., mimikatz, SharpHound)\n      \u2193\nLateral Movement via SMB/WMI/RDP/SSH\n      \u2193\nPost-access Credential Dumping on New Hosts\n      \u2193\nPrivilege Escalation \u2192 Repeat or Persist\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-opsec-considerations",children:"\ud83e\udde0 OPSEC Considerations"}),"\n",(0,i.jsxs)(n.p,{children:["Lateral movement is ",(0,i.jsx)(n.strong,{children:"high-risk"})," from a detection standpoint:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Endpoint Detection and Response (EDR) tools often monitor:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"PsExec patterns"}),"\n",(0,i.jsx)(n.li,{children:"Remote service creation"}),"\n",(0,i.jsxs)(n.li,{children:["Admin share access (e.g., ",(0,i.jsx)(n.code,{children:"C$"}),", ",(0,i.jsx)(n.code,{children:"ADMIN$"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"WMI and WinRM execution"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Logs to monitor:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Security.evtx"})," (event ID 4624, 4672)"]}),"\n",(0,i.jsx)(n.li,{children:"PowerShell logs (event ID 4104)"}),"\n",(0,i.jsx)(n.li,{children:"Sysmon logs (network connections, process creation)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-evasion-tips",children:"\ud83d\udd12 Evasion Tips"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.strong,{children:"in-memory execution"})," (e.g., BOFs, reflectively loaded DLLs)"]}),"\n",(0,i.jsx)(n.li,{children:"Rename known tooling binaries"}),"\n",(0,i.jsxs)(n.li,{children:["Abandon PsExec in favor of ",(0,i.jsx)(n.code,{children:"wmiexec.py"})," or C2-native features"]}),"\n",(0,i.jsx)(n.li,{children:"Stagger traffic and simulate user behavior"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-where-lateral-movement-fits",children:"\ud83e\udded Where Lateral Movement Fits"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Initial Access \u2192 Execution \u2192 Post-Ex Recon \u2192 Privilege Escalation \u2192 [ Lateral Movement ] \u2192 Credential Dumping \u2192 Objectives\n"})}),"\n",(0,i.jsxs)(n.p,{children:["It's often ",(0,i.jsx)(n.strong,{children:"iterative"}),", repeated as you discover more users, more systems, and gather more credentials."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-summary",children:"\ud83d\udccc Summary"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Lateral movement isn't just a pathway\u2014it's how red teamers and adversaries ",(0,i.jsx)(n.strong,{children:"conquer networks"}),". Without it, you're just a squatter on a box. With it, you're a threat actor expanding your territory."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Whether it's a domain controller or a Linux bastion host, lateral movement is how you reach your real targets."}),"\n",(0,i.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var s=t(6540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);