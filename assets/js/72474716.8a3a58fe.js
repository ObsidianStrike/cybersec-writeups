"use strict";(self.webpackChunkcybersec_writeups=self.webpackChunkcybersec_writeups||[]).push([[1569],{5903:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"concept/credential-access","title":"Credential Access Explained","description":"Understand what credential access is, how attackers obtain them, and why they\'re essential for privilege escalation and lateral movement.","source":"@site/docs/concept/credential-access.md","sourceDirName":"concept","slug":"/concept/credential-access","permalink":"/docs/concept/credential-access","draft":false,"unlisted":false,"editUrl":"https://github.com/ObsidianStrike/cybersec-writeups/tree/main/docs/concept/credential-access.md","tags":[{"inline":true,"label":"post-exploitation","permalink":"/docs/tags/post-exploitation"},{"inline":true,"label":"red-team","permalink":"/docs/tags/red-team"},{"inline":true,"label":"credential-access","permalink":"/docs/tags/credential-access"},{"inline":true,"label":"password-dumping","permalink":"/docs/tags/password-dumping"},{"inline":true,"label":"token-theft","permalink":"/docs/tags/token-theft"},{"inline":true,"label":"diataxis:explanation","permalink":"/docs/tags/diataxis-explanation"}],"version":"current","sidebarPosition":13,"frontMatter":{"id":"credential-access","title":"Credential Access Explained","description":"Understand what credential access is, how attackers obtain them, and why they\'re essential for privilege escalation and lateral movement.","slug":"/concept/credential-access","sidebar_label":"Creds","sidebar_position":13,"tags":["post-exploitation","red-team","credential-access","password-dumping","token-theft","diataxis:explanation"]},"sidebar":"tutorialSidebar","previous":{"title":"Persistence","permalink":"/docs/concept/persistence"},"next":{"title":"Priv Esc","permalink":"/docs/concept/priv-esc"}}');var r=n(4848),t=n(8453);const c={id:"credential-access",title:"Credential Access Explained",description:"Understand what credential access is, how attackers obtain them, and why they're essential for privilege escalation and lateral movement.",slug:"/concept/credential-access",sidebar_label:"Creds",sidebar_position:13,tags:["post-exploitation","red-team","credential-access","password-dumping","token-theft","diataxis:explanation"]},l="Credential Access",d={},a=[{value:"\ud83d\udd10 What Counts as a Credential?",id:"-what-counts-as-a-credential",level:2},{value:"\ud83e\udde0 Why Credential Access Matters",id:"-why-credential-access-matters",level:2},{value:"\ud83e\uddea Common Credential Theft Techniques",id:"-common-credential-theft-techniques",level:2},{value:"\ud83e\uddec Windows-Specific Artifacts",id:"-windows-specific-artifacts",level:2},{value:"\ud83d\udc27 Linux Targets",id:"-linux-targets",level:2},{value:"\ud83e\udde0 OPSEC and Detection",id:"-opsec-and-detection",level:2},{value:"\ud83d\udee1\ufe0f Monitored Behaviors",id:"\ufe0f-monitored-behaviors",level:3},{value:"\ud83d\udd12 Evasion Tips",id:"-evasion-tips",level:3},{value:"\ud83d\udccc Credential Theft Lifecycle",id:"-credential-theft-lifecycle",level:2},{value:"\ud83d\udca1 Real-World Examples",id:"-real-world-examples",level:2}];function o(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"credential-access",children:"Credential Access"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Credential Access"})," refers to the techniques adversaries use to ",(0,r.jsx)(s.strong,{children:"steal account credentials"}),"\u2014passwords, tokens, hashes, or Kerberos tickets\u2014from compromised systems."]}),"\n",(0,r.jsxs)(s.p,{children:["Credential theft is ",(0,r.jsx)(s.strong,{children:"one of the most impactful post-exploitation activities"})," because it enables:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Privilege escalation"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Lateral movement"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Persistence"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Impersonation of legitimate users"})}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-what-counts-as-a-credential",children:"\ud83d\udd10 What Counts as a Credential?"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Plaintext passwords"}),"\n",(0,r.jsx)(s.li,{children:"NTLM hashes (used for Pass-the-Hash)"}),"\n",(0,r.jsx)(s.li,{children:"Kerberos tickets (used for Pass-the-Ticket)"}),"\n",(0,r.jsx)(s.li,{children:"SSH private keys"}),"\n",(0,r.jsx)(s.li,{children:"Web cookies / API tokens"}),"\n",(0,r.jsx)(s.li,{children:"Vault credentials"}),"\n",(0,r.jsx)(s.li,{children:"Password manager exports"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-why-credential-access-matters",children:"\ud83e\udde0 Why Credential Access Matters"}),"\n",(0,r.jsxs)(s.p,{children:["Credentials are the ",(0,r.jsx)(s.strong,{children:"keys to the kingdom"})," in any environment."]}),"\n",(0,r.jsx)(s.p,{children:"Once an attacker captures one:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"They can impersonate the user in that context."}),"\n",(0,r.jsx)(s.li,{children:"If reused across services, the compromise spreads."}),"\n",(0,r.jsx)(s.li,{children:"If the user is privileged, the attacker gains full control."}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["It also supports ",(0,r.jsx)(s.strong,{children:"persistence"}),": even if malware is removed, valid credentials can provide access again."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-common-credential-theft-techniques",children:"\ud83e\uddea Common Credential Theft Techniques"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Technique"}),(0,r.jsx)(s.th,{children:"Target"}),(0,r.jsx)(s.th,{children:"Tooling"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"LSASS Dumping"})}),(0,r.jsx)(s.td,{children:"Local logon session creds"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"mimikatz"}),", ",(0,r.jsx)(s.code,{children:"procdump"}),", Cobalt Strike"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"SAM & SYSTEM Hive Dump"})}),(0,r.jsx)(s.td,{children:"Local account hashes"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"reg save"}),", ",(0,r.jsx)(s.code,{children:"secretsdump.py"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"DCSync"})}),(0,r.jsx)(s.td,{children:"Pull hashes from DC"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"mimikatz"}),", ",(0,r.jsx)(s.code,{children:"impacket-secretsdump"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Kerberos Ticket Harvesting"})}),(0,r.jsx)(s.td,{children:"TGT/TGS reuse"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"kerberoast"}),", ",(0,r.jsx)(s.code,{children:"Rubeus"}),", ",(0,r.jsx)(s.code,{children:"klist"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Credential Manager"})}),(0,r.jsx)(s.td,{children:"Windows vault data"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"cmdkey"}),", ",(0,r.jsx)(s.code,{children:"vaultcmd"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Memory Injection"})}),(0,r.jsx)(s.td,{children:"Inline creds in memory"}),(0,r.jsx)(s.td,{children:"Cobalt Strike BOFs, Sliver"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Web Credentials"})}),(0,r.jsx)(s.td,{children:"Browser stores"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"LaZagne"}),", ",(0,r.jsx)(s.code,{children:"SharpChrome"}),", ",(0,r.jsx)(s.code,{children:"TokenTactics"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Keylogging / Clipboard"})}),(0,r.jsx)(s.td,{children:"User input"}),(0,r.jsx)(s.td,{children:"Built-in to many C2s"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Phishing / Harvesting"})}),(0,r.jsx)(s.td,{children:"User-supplied via bait"}),(0,r.jsx)(s.td,{children:"HTA macros, spoofed portals"})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-windows-specific-artifacts",children:"\ud83e\uddec Windows-Specific Artifacts"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"lsass.exe"}),": Memory contains password hashes and Kerberos tickets."]}),"\n",(0,r.jsxs)(s.li,{children:["Registry hives:","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"HKLM\\SAM"})," \u2014 Local accounts"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"HKLM\\SYSTEM"})," \u2014 SysKey for decryption"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"HKLM\\SECURITY"})," \u2014 LSA secrets"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Credential Manager: ",(0,r.jsx)(s.code,{children:"cmdkey /list"})]}),"\n",(0,r.jsxs)(s.li,{children:["Token impersonation: ",(0,r.jsx)(s.code,{children:"mimikatz"})," or ",(0,r.jsx)(s.code,{children:"MakeToken"})," in C2"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-linux-targets",children:"\ud83d\udc27 Linux Targets"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/etc/shadow"}),": Hashes of local users (needs root)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"~/.ssh/id_rsa"}),": Private keys"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"~/.bash_history"}),", ",(0,r.jsx)(s.code,{children:".zshrc"}),": Command history revealing passwords"]}),"\n",(0,r.jsxs)(s.li,{children:["SSH agent: ",(0,r.jsx)(s.code,{children:"ssh-add -l"})]}),"\n",(0,r.jsxs)(s.li,{children:["Vaults like ",(0,r.jsx)(s.code,{children:"gnome-keyring"})," or ",(0,r.jsx)(s.code,{children:"KWallet"})]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-opsec-and-detection",children:"\ud83e\udde0 OPSEC and Detection"}),"\n",(0,r.jsxs)(s.p,{children:["Credential access is ",(0,r.jsx)(s.strong,{children:"high-value, high-risk"}),"."]}),"\n",(0,r.jsx)(s.h3,{id:"\ufe0f-monitored-behaviors",children:"\ud83d\udee1\ufe0f Monitored Behaviors"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"lsass.exe"})," access from non-system processes"]}),"\n",(0,r.jsx)(s.li,{children:"Registry exports of SAM/SYSTEM"}),"\n",(0,r.jsx)(s.li,{children:"High handle requests on sensitive processes"}),"\n",(0,r.jsxs)(s.li,{children:["DCSync attempts via event logs (",(0,r.jsx)(s.code,{children:"4662"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"cmdkey"}),", ",(0,r.jsx)(s.code,{children:"vaultcmd"})," execution"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"-evasion-tips",children:"\ud83d\udd12 Evasion Tips"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Use in-memory or BOF-based tools"}),"\n",(0,r.jsx)(s.li,{children:"Delay or stagger activity post-access"}),"\n",(0,r.jsxs)(s.li,{children:["Use ",(0,r.jsx)(s.code,{children:"rundll32"}),", ",(0,r.jsx)(s.code,{children:"comsvcs.dll"})," for stealth LSASS dumps"]}),"\n",(0,r.jsx)(s.li,{children:"Rename tooling or blend with legitimate system binaries (LOLBAS)"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-credential-theft-lifecycle",children:"\ud83d\udccc Credential Theft Lifecycle"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-plaintext",children:"Initial Access\n      \u2193\nProcess Injection / Persistence\n      \u2193\nCredential Dumping (LSASS / SAM / Vault)\n      \u2193\nLateral Movement (SMB / RDP / SSH)\n      \u2193\nRepeat\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Credential access is often ",(0,r.jsx)(s.strong,{children:"chained"}),", where new hosts yield new creds, leading to further access."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-real-world-examples",children:"\ud83d\udca1 Real-World Examples"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"APT29"})," uses Kerberos ticketing (Golden Ticket attacks)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Cobalt Strike users"})," frequently use ",(0,r.jsx)(s.code,{children:"sekurlsa::logonpasswords"})," after privilege escalation"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Sliver/Empire"})," modules automate SAM dump + reuse"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>l});var i=n(6540);const r={},t=i.createContext(r);function c(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);