"use strict";(self.webpackChunkcybersec_writeups=self.webpackChunkcybersec_writeups||[]).push([[9250],{7e3:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"concept/data-exfil","title":"Post-Exploitation Data Exfiltration","description":"Understand how attackers extract stolen data from compromised systems using stealthy and resilient techniques.","source":"@site/docs/concept/data-exfil.md","sourceDirName":"concept","slug":"/concept/data-exfil","permalink":"/docs/concept/data-exfil","draft":false,"unlisted":false,"editUrl":"https://github.com/ObsidianStrike/cybersec-writeups/tree/main/docs/concept/data-exfil.md","tags":[{"inline":true,"label":"post-exploitation","permalink":"/docs/tags/post-exploitation"},{"inline":true,"label":"data-exfiltration","permalink":"/docs/tags/data-exfiltration"},{"inline":true,"label":"diataxis:explanation","permalink":"/docs/tags/diataxis-explanation"},{"inline":true,"label":"attacker-objectives","permalink":"/docs/tags/attacker-objectives"},{"inline":true,"label":"T1041","permalink":"/docs/tags/t-1041"},{"inline":true,"label":"T1048","permalink":"/docs/tags/t-1048"},{"inline":true,"label":"T1567","permalink":"/docs/tags/t-1567"}],"version":"current","sidebarPosition":19,"frontMatter":{"id":"data-exfil","title":"Post-Exploitation Data Exfiltration","description":"Understand how attackers extract stolen data from compromised systems using stealthy and resilient techniques.","slug":"/concept/data-exfil","sidebar_label":"Data Exfil","sidebar_position":19,"tags":["post-exploitation","data-exfiltration","diataxis:explanation","attacker-objectives","T1041","T1048","T1567"]},"sidebar":"tutorialSidebar","previous":{"title":"Data Collection","permalink":"/docs/concept/data-collection"},"next":{"title":"Rules of Engagement","permalink":"/docs/how-to/Pre-Engagement/roe"}}');var i=s(4848),r=s(8453);const d={id:"data-exfil",title:"Post-Exploitation Data Exfiltration",description:"Understand how attackers extract stolen data from compromised systems using stealthy and resilient techniques.",slug:"/concept/data-exfil",sidebar_label:"Data Exfil",sidebar_position:19,tags:["post-exploitation","data-exfiltration","diataxis:explanation","attacker-objectives","T1041","T1048","T1567"]},l="\ud83d\udce4 Data Exfiltration: Explained",a={},c=[{value:"\ud83c\udfaf Why Exfiltration Matters",id:"-why-exfiltration-matters",level:2},{value:"\ud83d\udee3\ufe0f Exfiltration Paths (aka &quot;Channels&quot;)",id:"\ufe0f-exfiltration-paths-aka-channels",level:2},{value:"\ud83d\udd75\ufe0f Common Techniques",id:"\ufe0f-common-techniques",level:2},{value:"\u26a0\ufe0f OPSEC Considerations",id:"\ufe0f-opsec-considerations",level:2},{value:"\ud83d\udee0\ufe0f Tools Used in the Wild",id:"\ufe0f-tools-used-in-the-wild",level:2},{value:"\ud83d\udd0e Real-World Examples",id:"-real-world-examples",level:2},{value:"\ud83e\udde9 Defensive Strategies",id:"-defensive-strategies",level:2},{value:"\ud83d\udd1a Summary",id:"-summary",level:2}];function o(e){const t={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"-data-exfiltration-explained",children:"\ud83d\udce4 Data Exfiltration: Explained"})}),"\n",(0,i.jsxs)(t.p,{children:["Data exfiltration is the phase where attackers ",(0,i.jsx)(t.strong,{children:"move collected data out of the victim environment"}),". It\u2019s the transition from passive access to active theft\u2014often the phase most scrutinized by blue teams, auditors, and incident responders."]}),"\n",(0,i.jsx)(t.p,{children:"This stage follows reconnaissance, privilege escalation, and data collection\u2014and often precedes attacker withdrawal or persistence resets."}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"-why-exfiltration-matters",children:"\ud83c\udfaf Why Exfiltration Matters"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Exfiltration is the payoff."})," Whether the goal is espionage, extortion, or blackmail, exfiltrated data enables adversaries to:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Sell or leak sensitive data."}),"\n",(0,i.jsx)(t.li,{children:"Leverage information for political or financial gain."}),"\n",(0,i.jsx)(t.li,{children:"Abuse credentials and secrets in later campaigns."}),"\n",(0,i.jsx)(t.li,{children:"Destroy trust and reputations."}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Often, attackers ",(0,i.jsx)(t.strong,{children:"stage"})," data in a local archive (e.g., ",(0,i.jsx)(t.code,{children:".zip"}),", ",(0,i.jsx)(t.code,{children:".rar"}),", ",(0,i.jsx)(t.code,{children:".7z"}),") and then extract it from the system in ways designed to avoid detection or trigger minimal alerts."]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"\ufe0f-exfiltration-paths-aka-channels",children:'\ud83d\udee3\ufe0f Exfiltration Paths (aka "Channels")'}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Channel"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"MITRE ID"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83c\udf10 HTTP/HTTPS"}),(0,i.jsx)(t.td,{children:"Upload via web traffic or reverse proxy (e.g., C2 server)"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"T1041"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udce9 Email"}),(0,i.jsx)(t.td,{children:"Send stolen files as attachments or body payloads"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"T1048.003"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udcc1 Cloud Services"}),(0,i.jsx)(t.td,{children:"Google Drive, Dropbox, OneDrive, MEGA, etc."}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"T1567.002"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udce1 DNS Tunneling"}),(0,i.jsx)(t.td,{children:"Encode data in DNS queries"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"T1048.002"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd17 SMB/WebDAV Shares"}),(0,i.jsx)(t.td,{children:"Push to mounted network shares or WebDAV endpoints"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"T1020"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd0c External Drive"}),(0,i.jsx)(t.td,{children:"Manual copy to USB or mapped removable drives"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"T1052"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd04 C2 Protocols"}),(0,i.jsx)(t.td,{children:"Exfil via beacon channels (e.g., Cobalt Strike, Covenant)"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"T1041"}),", ",(0,i.jsx)(t.code,{children:"T1095"})]})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"\ufe0f-common-techniques",children:"\ud83d\udd75\ufe0f Common Techniques"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Technique"}),(0,i.jsx)(t.th,{children:"Notes"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd12 Use of Encrypted Channels"}),(0,i.jsx)(t.td,{children:"HTTPS or DNS over HTTPS to bypass inspection"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83e\uddf3 Staging Archives"}),(0,i.jsx)(t.td,{children:"Compress data to reduce size and evade filters"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83e\udea4 File Masquerading"}),(0,i.jsxs)(t.td,{children:["Rename ",(0,i.jsx)(t.code,{children:".rar"})," or ",(0,i.jsx)(t.code,{children:".7z"})," to ",(0,i.jsx)(t.code,{children:".jpg"}),", ",(0,i.jsx)(t.code,{children:".docx"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83e\uddec Steganography"}),(0,i.jsx)(t.td,{children:"Embed files in images or audio"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd01 Chunked Exfiltration"}),(0,i.jsx)(t.td,{children:"Send partial data in chunks to avoid DLP detection"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\u23f1\ufe0f Timing Evasion"}),(0,i.jsx)(t.td,{children:"Exfil during off-hours or spread over long intervals"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"\ufe0f-opsec-considerations",children:"\u26a0\ufe0f OPSEC Considerations"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Vector"}),(0,i.jsx)(t.th,{children:"Why It Matters"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"DLP Systems"}),(0,i.jsx)(t.td,{children:"Trigger on sensitive data signatures or extensions"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Traffic Anomalies"}),(0,i.jsx)(t.td,{children:"Sudden upload spikes raise red flags"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Protocol Misuse"}),(0,i.jsx)(t.td,{children:"DNS overuse or ICMP with payloads is suspicious"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"EDR/AV Correlation"}),(0,i.jsx)(t.td,{children:"May detect archive creation and transfer behaviors"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Proxy Logging"}),(0,i.jsx)(t.td,{children:"Reveals URLs, destinations, file sizes"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"\ufe0f-tools-used-in-the-wild",children:"\ud83d\udee0\ufe0f Tools Used in the Wild"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Tool / Technique"}),(0,i.jsx)(t.th,{children:"Function"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:["\ud83e\uddf0 ",(0,i.jsx)(t.code,{children:"Rclone"})]}),(0,i.jsx)(t.td,{children:"Sync data to cloud endpoints"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:["\ud83d\udc0d ",(0,i.jsx)(t.code,{children:"Exfiltrator-TS"})]}),(0,i.jsx)(t.td,{children:"Exfiltrate over multiple protocols"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:["\ud83d\udcbb ",(0,i.jsx)(t.code,{children:"PowerShell"})," + ",(0,i.jsx)(t.code,{children:"Invoke-WebRequest"})]}),(0,i.jsx)(t.td,{children:"Upload to attacker-controlled hosts"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:["\ud83d\udce6 ",(0,i.jsx)(t.code,{children:"curl"})," / ",(0,i.jsx)(t.code,{children:"wget"})]}),(0,i.jsx)(t.td,{children:"Push archives to HTTP servers"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83e\udeaa Custom malware"}),(0,i.jsx)(t.td,{children:"Embeds data exfil in beacon callbacks"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"-real-world-examples",children:"\ud83d\udd0e Real-World Examples"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Incident"}),(0,i.jsx)(t.th,{children:"Exfil Method"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"SolarWinds / UNC2452"}),(0,i.jsx)(t.td,{children:"Encrypted HTTP POST traffic to C2"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Lazarus Group (Sony Breach)"}),(0,i.jsx)(t.td,{children:"Manual ZIP + transfer via SMB"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Conti Playbook"}),(0,i.jsx)(t.td,{children:"Rclone sync to MEGA.nz"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"APT28 (Fancy Bear)"}),(0,i.jsx)(t.td,{children:"DNS tunneling via custom implant"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"-defensive-strategies",children:"\ud83e\udde9 Defensive Strategies"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Control"}),(0,i.jsx)(t.th,{children:"Countermeasure"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udcbc Egress Filtering"}),(0,i.jsx)(t.td,{children:"Block unnecessary outbound protocols"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd0d DLP Systems"}),(0,i.jsx)(t.td,{children:"Detect keywords, extensions, patterns"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udcc9 Network Anomaly Detection"}),(0,i.jsx)(t.td,{children:"Alert on spikes in outbound traffic"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udd11 Zero Trust Access"}),(0,i.jsx)(t.td,{children:"Restrict upload permissions per context"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"\ud83d\udce6 File Access Monitoring"}),(0,i.jsx)(t.td,{children:"Detect ZIP creation or mass reads"})]})]})]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"-summary",children:"\ud83d\udd1a Summary"}),"\n",(0,i.jsxs)(t.p,{children:["Exfiltration marks the ",(0,i.jsx)(t.strong,{children:"final step"})," in a successful compromise, where data moves from your systems to attacker-controlled infrastructure."]}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"\ud83e\udde0 \u201cIf you\u2019re monitoring ingress but not egress, you\u2019re half-blind.\u201d"}),"\n"]}),"\n",(0,i.jsx)(t.hr,{})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>l});var n=s(6540);const i={},r=n.createContext(i);function d(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);