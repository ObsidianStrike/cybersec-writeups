"use strict";(self.webpackChunkcybersec_writeups=self.webpackChunkcybersec_writeups||[]).push([[8179],{652:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"concept/priv-esc","title":"Privilege Escalation Explained","description":"Understand what privilege escalation is, why it matters, and how attackers leverage it during operations.","source":"@site/docs/concept/priv-esc.md","sourceDirName":"concept","slug":"/concept/priv-esc","permalink":"/docs/concept/priv-esc","draft":false,"unlisted":false,"editUrl":"https://github.com/ObsidianStrike/cybersec-writeups/tree/main/docs/concept/priv-esc.md","tags":[{"inline":true,"label":"post-exploitation","permalink":"/docs/tags/post-exploitation"},{"inline":true,"label":"red-team","permalink":"/docs/tags/red-team"},{"inline":true,"label":"escalation","permalink":"/docs/tags/escalation"},{"inline":true,"label":"windows","permalink":"/docs/tags/windows"},{"inline":true,"label":"linux","permalink":"/docs/tags/linux"},{"inline":true,"label":"diataxis:explanation","permalink":"/docs/tags/diataxis-explanation"}],"version":"current","sidebarPosition":14,"frontMatter":{"id":"priv-esc","title":"Privilege Escalation Explained","description":"Understand what privilege escalation is, why it matters, and how attackers leverage it during operations.","slug":"/concept/priv-esc","sidebar_label":"Priv Esc","sidebar_position":14,"tags":["post-exploitation","red-team","escalation","windows","linux","diataxis:explanation"]},"sidebar":"tutorialSidebar","previous":{"title":"Creds","permalink":"/docs/concept/credential-access"},"next":{"title":"Lateral Movement","permalink":"/docs/concept/lateral-movement"}}');var r=i(4848),t=i(8453);const l={id:"priv-esc",title:"Privilege Escalation Explained",description:"Understand what privilege escalation is, why it matters, and how attackers leverage it during operations.",slug:"/concept/priv-esc",sidebar_label:"Priv Esc",sidebar_position:14,tags:["post-exploitation","red-team","escalation","windows","linux","diataxis:explanation"]},c="Privilege Escalation",o={},a=[{value:"\ud83d\udca1 Why Privilege Escalation Matters",id:"-why-privilege-escalation-matters",level:2},{value:"\ud83d\udd0d Types of Privilege Escalation",id:"-types-of-privilege-escalation",level:2},{value:"\ud83e\udded Horizontal vs Vertical",id:"-horizontal-vs-vertical",level:3},{value:"\ud83e\ude9f On Windows",id:"-on-windows",level:3},{value:"\ud83d\udc27 On Linux/macOS",id:"-on-linuxmacos",level:3},{value:"\ud83d\udee0 Tools &amp; Techniques",id:"-tools--techniques",level:2},{value:"\ud83e\udde0 OPSEC Considerations",id:"-opsec-considerations",level:2},{value:"\ud83c\udfaf Goals After Escalation",id:"-goals-after-escalation",level:2},{value:"\ud83e\udded Where Does PrivEsc Fit?",id:"-where-does-privesc-fit",level:2},{value:"\ud83d\udccc Summary",id:"-summary",level:2}];function d(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"privilege-escalation",children:"Privilege Escalation"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Privilege Escalation (PrivEsc)"})," is the process of gaining ",(0,r.jsx)(s.strong,{children:"higher-level permissions"})," on a system than initially granted\u2014usually moving from a limited user to administrative (Windows: ",(0,r.jsx)(s.code,{children:"Administrator"}),", ",(0,r.jsx)(s.code,{children:"SYSTEM"}),"; Linux: ",(0,r.jsx)(s.code,{children:"root"}),")."]}),"\n",(0,r.jsxs)(s.p,{children:["In red teaming and adversary simulations, this is a ",(0,r.jsx)(s.strong,{children:"critical post-exploitation milestone"}),", enabling control, persistence, and pivoting within a network."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-why-privilege-escalation-matters",children:"\ud83d\udca1 Why Privilege Escalation Matters"}),"\n",(0,r.jsxs)(s.p,{children:["Initial access often lands an operator in a ",(0,r.jsx)(s.strong,{children:"restricted context"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Limited shell from a phished user"}),"\n",(0,r.jsxs)(s.li,{children:["Web app RCE as ",(0,r.jsx)(s.code,{children:"www-data"})]}),"\n",(0,r.jsx)(s.li,{children:"Initial C2 beacon running as a service account"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"With these constraints, the attacker can't:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Install persistence mechanisms in protected areas"}),"\n",(0,r.jsx)(s.li,{children:"Access credential stores (e.g., SAM, LSA secrets, LSASS)"}),"\n",(0,r.jsx)(s.li,{children:"Dump memory or sensitive logs"}),"\n",(0,r.jsx)(s.li,{children:"Manipulate system services or security settings"}),"\n",(0,r.jsx)(s.li,{children:"Move laterally across boundaries like UAC, domains, or containers"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"PrivEsc unlocks post-ex capabilities"}),", turning a foothold into a beachhead."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-types-of-privilege-escalation",children:"\ud83d\udd0d Types of Privilege Escalation"}),"\n",(0,r.jsx)(s.h3,{id:"-horizontal-vs-vertical",children:"\ud83e\udded Horizontal vs Vertical"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Vertical"})}),(0,r.jsxs)(s.td,{children:["Low \u2192 High (e.g., ",(0,r.jsx)(s.code,{children:"user"})," \u2192 ",(0,r.jsx)(s.code,{children:"SYSTEM"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Horizontal"})}),(0,r.jsx)(s.td,{children:"Lateral in scope, gaining access to another user\u2019s account with equivalent privileges, often for access to different resources"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"-on-windows",children:"\ud83e\ude9f On Windows"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Category"}),(0,r.jsx)(s.th,{children:"Examples"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Unquoted Service Paths"})}),(0,r.jsx)(s.td,{children:"Services with spaces in path without quotes"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Insecure Registry Permissions"})}),(0,r.jsxs)(s.td,{children:["Writeable keys in ",(0,r.jsx)(s.code,{children:"HKLM\\SYSTEM\\..."})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"DLL Hijacking"})}),(0,r.jsx)(s.td,{children:"Abuse of DLL load order in services or apps"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Token Impersonation"})}),(0,r.jsxs)(s.td,{children:["Steal or impersonate tokens (e.g., ",(0,r.jsx)(s.code,{children:"Incognito"}),", ",(0,r.jsx)(s.code,{children:"PrintSpoofer"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"UAC Bypass"})}),(0,r.jsxs)(s.td,{children:["Masquerading as trusted binaries (",(0,r.jsx)(s.code,{children:"fodhelper.exe"}),", ",(0,r.jsx)(s.code,{children:"eventvwr.exe"}),")"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Scheduled Tasks"})}),(0,r.jsx)(s.td,{children:"Abuse of misconfigured or writable tasks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"AlwaysInstallElevated"})}),(0,r.jsx)(s.td,{children:"Misconfigured installer policies"})]})]})]}),"\n",(0,r.jsx)(s.h3,{id:"-on-linuxmacos",children:"\ud83d\udc27 On Linux/macOS"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Category"}),(0,r.jsx)(s.th,{children:"Examples"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"SUID Binaries"})}),(0,r.jsxs)(s.td,{children:["Find misconfigured files with ",(0,r.jsx)(s.code,{children:"find / -perm -4000"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Cron Jobs"})}),(0,r.jsx)(s.td,{children:"Writable or weakly configured scheduled tasks"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Shell Escapes"})}),(0,r.jsx)(s.td,{children:"From limited shells into full TTYs"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Weak Permissions"})}),(0,r.jsx)(s.td,{children:"Writable system scripts run by root"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"Kernel Exploits"})}),(0,r.jsx)(s.td,{children:"e.g., Dirty COW, Dirty Pipe, Stack Clash"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.strong,{children:"PATH Hijacking"})}),(0,r.jsxs)(s.td,{children:["Replace binaries in ",(0,r.jsx)(s.code,{children:"PATH"})," if running as root"]})]})]})]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-tools--techniques",children:"\ud83d\udee0 Tools & Techniques"}),"\n",(0,r.jsx)(s.p,{children:"Popular enumeration and escalation tools include:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Windows"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/GhostPack/Seatbelt",children:"Seatbelt"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/PowerShellMafia/PowerSploit",children:"PowerUp"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/rasta-mouse/Watson",children:"Watson"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Linux"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/carlospolop/PEASS-ng",children:"LinPEAS"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/mzet-/linux-exploit-suggester",children:"Linux Exploit Suggester"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://gtfobins.github.io/",children:"GTFOBins"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"These tools automate the detection of misconfigs and exploitation pathways."}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-opsec-considerations",children:"\ud83e\udde0 OPSEC Considerations"}),"\n",(0,r.jsx)(s.p,{children:"Privilege escalation often involves:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Writing to disk (exploits, binaries)"}),"\n",(0,r.jsx)(s.li,{children:"Loading unsigned code or DLLs"}),"\n",(0,r.jsxs)(s.li,{children:["Triggering EDR-monitored events (e.g., ",(0,r.jsx)(s.code,{children:"reg add"}),", ",(0,r.jsx)(s.code,{children:"schtasks"}),", ",(0,r.jsx)(s.code,{children:"seclogon"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Mitigation"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Use in-memory techniques (e.g., Cobalt Strike\u2019s Beacon, Sliver\u2019s BOFs)"}),"\n",(0,r.jsx)(s.li,{children:"Abuse native tools and avoid spawning child processes"}),"\n",(0,r.jsx)(s.li,{children:"Clean up logs and artifacts after testing exploitability"}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-goals-after-escalation",children:"\ud83c\udfaf Goals After Escalation"}),"\n",(0,r.jsx)(s.p,{children:"Once escalation is successful:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Dump credentials"})," from LSASS or SAM"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Pivot"})," to sensitive services (SQL, RDP, AD tools)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Establish persistence"})," with higher integrity"]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Modify or disable AV/EDR settings"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Hijack network-bound processes"})}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-where-does-privesc-fit",children:"\ud83e\udded Where Does PrivEsc Fit?"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Initial Access \u2192 Execution \u2192 [ Post-Ex Recon ] \u2192 [ Privilege Escalation ] \u2192 Persistence \u2192 Lateral Movement \u2192 Objectives\n"})}),"\n",(0,r.jsxs)(s.p,{children:["It often occurs ",(0,r.jsx)(s.strong,{children:"early"})," in the post-exploitation phase, enabling or enhancing the effectiveness of all other actions."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-summary",children:"\ud83d\udccc Summary"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"Privilege escalation isn\u2019t just about admin rights\u2014it\u2019s about control. It widens your operational scope, enhances stealth and durability, and sets the stage for deeper access and broader compromise."}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Whether you're simulating adversaries or defending real networks, understanding escalation is foundational."}),"\n",(0,r.jsx)(s.hr,{})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,s,i)=>{i.d(s,{R:()=>l,x:()=>c});var n=i(6540);const r={},t=n.createContext(r);function l(e){const s=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(t.Provider,{value:s},e.children)}}}]);