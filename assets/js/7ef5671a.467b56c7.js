"use strict";(self.webpackChunkcybersec_writeups=self.webpackChunkcybersec_writeups||[]).push([[827],{2920:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"how-to/Pre-Engagement/threat-model","title":"How to Create a Threat Model for an Adversary Simulation","description":"---","source":"@site/docs/how-to/Pre-Engagement/threat-model.md","sourceDirName":"how-to/Pre-Engagement","slug":"/how-to/Pre-Engagement/threat-model","permalink":"/docs/how-to/Pre-Engagement/threat-model","draft":false,"unlisted":false,"editUrl":"https://github.com/ObsidianStrike/cybersec-writeups/tree/main/docs/how-to/Pre-Engagement/threat-model.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"id":"threat-model","title":"How to Create a Threat Model for an Adversary Simulation","sidebar_label":"Threat Modeling","sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Scope of Work","permalink":"/docs/how-to/Pre-Engagement/sow"},"next":{"title":"Client Questionnaire","permalink":"/docs/how-to/Pre-Engagement/client-questionnaire"}}');var s=n(4848),r=n(8453);const l={id:"threat-model",title:"How to Create a Threat Model for an Adversary Simulation",sidebar_label:"Threat Modeling",sidebar_position:3},d=void 0,a={},c=[{value:"Objective",id:"objective",level:3},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Step-by-Step Instructions",id:"step-by-step-instructions",level:3},{value:"\ud83e\udde0 1. Understand the Client\u2019s Business and Risk Profile",id:"-1-understand-the-clients-business-and-risk-profile",level:4},{value:"\ud83d\udd0d 2. Select an Adversary Type to Emulate",id:"-2-select-an-adversary-type-to-emulate",level:4},{value:"\ud83e\uddf0 3. Build a TTP Matrix Based on MITRE ATT&amp;CK",id:"-3-build-a-ttp-matrix-based-on-mitre-attck",level:4},{value:"\ud83e\uddd7 4. Align Objectives to the Threat Model",id:"-4-align-objectives-to-the-threat-model",level:4},{value:"\ud83d\udee1\ufe0f 5. Validate with Stakeholders",id:"\ufe0f-5-validate-with-stakeholders",level:4},{value:"Example Template (Simplified)",id:"example-template-simplified",level:3},{value:"Summary",id:"summary",level:3}];function o(e){const t={a:"a",code:"code",em:"em",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"objective",children:"Objective"}),"\n",(0,s.jsxs)(t.p,{children:["Define a realistic and relevant ",(0,s.jsx)(t.strong,{children:"threat model"})," to guide a Red Team operation. A strong threat model ensures the engagement simulates credible adversaries, aligns with the client's industry risks, and validates their real-world security posture."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Scoping and pre-engagement activities completed"}),"\n",(0,s.jsx)(t.li,{children:"Access to stakeholder input on business risk, industry, and past incidents"}),"\n",(0,s.jsx)(t.li,{children:"Familiarity with the MITRE ATT&CK framework and known APT profiles"}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"step-by-step-instructions",children:"Step-by-Step Instructions"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h4,{id:"-1-understand-the-clients-business-and-risk-profile",children:"\ud83e\udde0 1. Understand the Client\u2019s Business and Risk Profile"}),"\n",(0,s.jsx)(t.p,{children:"Start by identifying:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Industry vertical"})," (e.g., healthcare, finance, manufacturing)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Threat exposure"})," (e.g., ransomware, IP theft, insider risk)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Critical business functions"})," (e.g., payment processing, ERP, customer portals)"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\ud83d\udccc ",(0,s.jsx)(t.em,{children:"Ask:"})," What kind of attacker keeps your CISO up at night?"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h4,{id:"-2-select-an-adversary-type-to-emulate",children:"\ud83d\udd0d 2. Select an Adversary Type to Emulate"}),"\n",(0,s.jsx)(t.p,{children:"Choose a threat actor class that matches the client\u2019s environment:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Adversary Type"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Nation-state/APT"})}),(0,s.jsx)(t.td,{children:"Long-dwell, stealthy, highly capable (e.g., APT29, APT41)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Cybercriminal"})}),(0,s.jsx)(t.td,{children:"Ransomware, initial access brokers (e.g., FIN7, Conti)"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Insider Threat"})}),(0,s.jsx)(t.td,{children:"Disgruntled employees, contractors, third-party abuse"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Hacktivist"})}),(0,s.jsx)(t.td,{children:"Political or ideological actors, often target public-facing systems"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["Optionally choose a ",(0,s.jsx)(t.strong,{children:"named threat group"})," from MITRE or CTI feeds to build realism."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h4,{id:"-3-build-a-ttp-matrix-based-on-mitre-attck",children:"\ud83e\uddf0 3. Build a TTP Matrix Based on MITRE ATT&CK"}),"\n",(0,s.jsxs)(t.p,{children:["Use ",(0,s.jsx)(t.a,{href:"https://attack.mitre.org",children:"https://attack.mitre.org"})," or Threat Intelligence reports to gather:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Initial Access: ",(0,s.jsx)(t.code,{children:"T1566.001 \u2013 Spearphishing Attachment"})]}),"\n",(0,s.jsxs)(t.li,{children:["Execution: ",(0,s.jsx)(t.code,{children:"T1059 \u2013 Command and Scripting Interpreter"})]}),"\n",(0,s.jsxs)(t.li,{children:["Credential Access: ",(0,s.jsx)(t.code,{children:"T1003 \u2013 OS Credential Dumping"})]}),"\n",(0,s.jsxs)(t.li,{children:["Lateral Movement: ",(0,s.jsx)(t.code,{children:"T1021 \u2013 Remote Services"})]}),"\n",(0,s.jsxs)(t.li,{children:["Exfiltration: ",(0,s.jsx)(t.code,{children:"T1041 \u2013 Exfil over C2 Channel"})]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\ud83d\udcc4 ",(0,s.jsx)(t.em,{children:"Deliverable:"})," A table or matrix of selected techniques by phase."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h4,{id:"-4-align-objectives-to-the-threat-model",children:"\ud83e\uddd7 4. Align Objectives to the Threat Model"}),"\n",(0,s.jsx)(t.p,{children:"Translate the model into measurable goals:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"\u201cCan we simulate data exfiltration from a dev share using stealthy C2?\u201d"}),"\n",(0,s.jsx)(t.li,{children:"\u201cCan an attacker escalate from user-level access to domain admin?\u201d"}),"\n",(0,s.jsx)(t.li,{children:"\u201cCan the Blue Team detect lateral movement from a compromised endpoint?\u201d"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Each tactic should tie back to:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"A known adversary capability"}),"\n",(0,s.jsx)(t.li,{children:"A defensive detection/response control"}),"\n",(0,s.jsx)(t.li,{children:"A mission-critical business risk"}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h4,{id:"\ufe0f-5-validate-with-stakeholders",children:"\ud83d\udee1\ufe0f 5. Validate with Stakeholders"}),"\n",(0,s.jsx)(t.p,{children:"Walk through the threat model with:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Security leadership (to confirm realism)"}),"\n",(0,s.jsx)(t.li,{children:"Legal/compliance (to vet method legality)"}),"\n",(0,s.jsx)(t.li,{children:"IT and IR (optional for purple teaming or assumed breach setups)"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\ud83d\udccc ",(0,s.jsx)(t.em,{children:"Tip:"})," Ask for feedback on ",(0,s.jsx)(t.strong,{children:"relevance"}),", not ",(0,s.jsx)(t.strong,{children:"technicality"}),"."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"example-template-simplified",children:"Example Template (Simplified)"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Phase"}),(0,s.jsx)(t.th,{children:"Tactic"}),(0,s.jsx)(t.th,{children:"Technique ID"}),(0,s.jsx)(t.th,{children:"Tool/Method"}),(0,s.jsx)(t.th,{children:"Justification"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Initial Access"}),(0,s.jsx)(t.td,{children:"Phishing"}),(0,s.jsx)(t.td,{children:"T1566.002"}),(0,s.jsx)(t.td,{children:"Macro-armed XLSX"}),(0,s.jsx)(t.td,{children:"Matches APT29 behavior in industry X"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Execution"}),(0,s.jsx)(t.td,{children:"PowerShell"}),(0,s.jsx)(t.td,{children:"T1059.001"}),(0,s.jsx)(t.td,{children:"Obfuscated one-liner"}),(0,s.jsx)(t.td,{children:"Bypasses AppLocker and EDR"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Priv Esc"}),(0,s.jsx)(t.td,{children:"Token Impersonation"}),(0,s.jsx)(t.td,{children:"T1134.001"}),(0,s.jsx)(t.td,{children:"Rubeus"}),(0,s.jsx)(t.td,{children:"Common in post-ex scenarios"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Lateral Movement"}),(0,s.jsx)(t.td,{children:"SMB Admin Shares"}),(0,s.jsx)(t.td,{children:"T1021.002"}),(0,s.jsx)(t.td,{children:"PsExec"}),(0,s.jsx)(t.td,{children:"Valid technique for domain move"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Exfiltration"}),(0,s.jsx)(t.td,{children:"Encrypted Web Traffic"}),(0,s.jsx)(t.td,{children:"T1041"}),(0,s.jsx)(t.td,{children:"HTTPS C2 beacon"}),(0,s.jsx)(t.td,{children:"Matches Conti RaaS TTPs"})]})]})]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h3,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"A good threat model is more than a checklist \u2014 it\u2019s a tactical playbook backed by intelligence. It ensures Red Team operations are grounded in realism, relevance, and risk."}),"\n",(0,s.jsxs)(t.p,{children:["Use the model to ",(0,s.jsx)(t.strong,{children:"guide tooling"}),", ",(0,s.jsx)(t.strong,{children:"shape payloads"}),", and ",(0,s.jsx)(t.strong,{children:"define victory"})," \u2014 not just emulate attackers, but out-think them."]}),"\n",(0,s.jsx)(t.hr,{})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>d});var i=n(6540);const s={},r=i.createContext(s);function l(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);